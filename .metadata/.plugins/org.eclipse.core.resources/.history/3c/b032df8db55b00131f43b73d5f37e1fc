//**********************************************************************************************************************************
// FILE: main.c
//**********************************************************************************************************************************
#include <stdio.h> // For printf()
#include "i2c.h" // For enumerated type i2c_mod
#include "oct_nunchuk.h" 
#include "pit.h"
//==================================================================================================================================
// Private Preprocessor Macros
//==================================================================================================================================
#define forever while (1)
//==================================================================================================================================
// Static Function Definitions
//==================================================================================================================================
static void hw_init();
static void console_update();
static void sw_init();
//==================================================================================================================================
// Private Global Variables
//==================================================================================================================================
static volatile int g_console_update;
//==================================================================================================================================
// Function Definitions
//==================================================================================================================================
//----------------------------------------------------------------------------------------------------------------------------------
// FUNCTION: g_console_update()
//
// DESCRIPTION
// Called by PIT 0 ISR at 1 Hz to update the console with the Wii Nunchuk state information.
//----------------------------------------------------------------------------------------------------------------------------------
static void console_update()
{
 g_console_update = 1;
}
//----------------------------------------------------------------------------------------------------------------------------------
// FUNCTION: hw_init()
//
// DESCRIPTION
// Initializes the MCF52259 hardware peripherals.
//----------------------------------------------------------------------------------------------------------------------------------
static void hw_init()
{
 int_inhibit_all();
 //oct_nunchuk_init(i2c_mod_1); //(OFFICIAL ONE)
 //oct_nunchuk_init(); // NEW
 
 //pit_init(pit_timer_0, pit_freq_1_hz, console_update); // (OFFICIAL ONE)
 //pit0_init(int_isr p_callback, int p_scaler); // NEW
 
 int_uninhibit_all();
}
//----------------------------------------------------------------------------------------------------------------------------------
// FUNCTION: main()
//----------------------------------------------------------------------------------------------------------------------------------
int main()
{
 hw_init();
 sw_init();
 forever {
	 printf("Hi\n");
		 printf("%d %d %d %d %d %d %d\n",
		 oct_nunchuk_pos_x(),
		 oct_nunchuk_pos_y(),
		 oct_nunchuk_accel_x(),
		 oct_nunchuk_accel_y(),
		 oct_nunchuk_accel_z(),
		 oct_nunchuk_button_c(),
		 oct_nunchuk_button_z()
		 );
 g_console_update = 0;
 }
}

//----------------------------------------------------------------------------------------------------------------------------------
// FUNCTION: sw_init()
//
// DESCRIPTION
// Software initialization.
//----------------------------------------------------------------------------------------------------------------------------------
static void sw_init()
{
 g_console_update = 1;
}
